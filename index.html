<html>
  <head>
    <link rel="stylesheet" href="index.css">
  </head>
  <body>
    <h1>A Pokemon Capture Game</h1>

    <div id="name"></div>
    <div id="sprite"></div>
    <div id="hp">hit point: </div>
    <div class="button-container">
      <button class="button" onClick="newPokemon()">Find New Pokemon!</button>
      <button class="button" onClick="hit()">Hit with a stick</button>
      <button class="button" onClick="catchPokemon()">Catch Pokemon</button>
    </div>

    <h6>Your Pokemon</h6>
    <div id="yourPokemon"></div>

    <script>
      let pokemon = {};
      let yourPokemon = [];

      const hit = () => {
        pokemon.hp = pokemon.hp - Math.floor(Math.random() * 50)
        console.log('pokemon is ', pokemon)
        console.log('pokemon.hp is ', pokemon.hp)
        document.getElementById("hp").innerHTML = `<h3>HP:  + ${pokemon.hp}`
      }

      const drawYourPokemon = () => {
        console.log("inside drawYourPokemon")
        let newHtml = "";
        for (var i = 0; i < yourPokemon.length; i++) {
          newHtml += `<img src="${yourPokemon[i]}">`
        }
        console.log("newHtml is ", newHtml)
        document.getElementById("yourPokemon").innerHTML = newHtml
      }

      const catchPokemon = () => {
        let chanceToCatch = pokemon.hp / pokemon.base_hp;
        Math.random()
        if(Math.random() > chanceToCatch) {
          yourPokemon.push(pokemon.sprite);
          newPokemon();
          drawYourPokemon();
          console.log("pokemon caught")
        } 
        else {
          console.log("failed to catch pokemon")
        }
      }

      async function newPokemon() {
        let num = Math.floor(Math.random() * 500)
        console.log('num is ', num)
        fetch(`https://pokeapi.co/api/v2/pokemon/${num}`)
          .then(response => response.json())
          .then(data => {
            console.log('data is ', data)
            pokemon.name = data.name
            pokemon.sprite = data.sprites.front_default
            pokemon.hp = data.stats[0].base_stat
            pokemon.base_hp = data.stats[0].base_stat
            console.log('pokemon is ', pokemon)
            console.log('yourPokemon is ', yourPokemon)
            document.getElementById("name").innerHTML = pokemon.name
            document.getElementById("sprite").innerHTML = `<img src="${pokemon.sprite}">`
          })
      }
      newPokemon();
    </script>
  </body>
</html>